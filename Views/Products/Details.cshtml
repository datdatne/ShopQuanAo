@model ShopQuanAo.Models.Product

@{
    ViewData["Title"] = Model.Name;
}

<!-- BREADCRUMB -->
<div class="bg-light py-3 mb-4">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb mb-0">
                <li class="breadcrumb-item"><a asp-controller="Home" asp-action="Index">Trang chủ</a></li>
                <li class="breadcrumb-item"><a asp-controller="Products" asp-action="Index">Sản phẩm</a></li>
                <li class="breadcrumb-item"><a asp-controller="Products" asp-action="Index" asp-route-categoryId="@Model.CategoryId">@Model.Category.Name</a></li>
                <li class="breadcrumb-item active">@Model.Name</li>
            </ol>
        </nav>
    </div>
</div>

<div class="container">
    <div class="row g-4">
        <!-- PRODUCT IMAGE -->
        <div class="col-lg-6">
            <div class="product-image-container">
                <div class="main-image-wrapper">
                    @if (!string.IsNullOrEmpty(Model.ImageUrl))
                    {
                        <img src="@Model.ImageUrl" class="img-fluid rounded shadow-lg" alt="@Model.Name" id="mainImage">
                    }
                    else
                    {
                        <div class="no-image">
                            <i class="bi bi-image"></i>
                            <p>Chưa có hình ảnh</p>
                        </div>
                    }

                    <!-- Badges -->
                    <div class="image-badges">
                        @if (Model.Stock == 0)
                        {
                            <span class="badge bg-danger">Hết hàng</span>
                        }
                        else if (Model.Stock < 10)
                        {
                            <span class="badge bg-warning text-dark">Sắp hết</span>
                        }
                        else if (Model.Stock > 50)
                        {
                            <span class="badge bg-success">Hot</span>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- PRODUCT INFO -->
        <div class="col-lg-6">
            <div class="product-details">
                <!-- Category -->
                <div class="mb-3">
                    <span class="category-badge">
                        <i class="bi bi-tag me-1"></i> @Model.Category.Name
                    </span>
                </div>

                <!-- Product Name -->
                <h2 class="product-title mb-3">@Model.Name</h2>

                <!-- Rating (Placeholder) -->
                <div class="rating mb-3">
                    <i class="bi bi-star-fill text-warning"></i>
                    <i class="bi bi-star-fill text-warning"></i>
                    <i class="bi bi-star-fill text-warning"></i>
                    <i class="bi bi-star-fill text-warning"></i>
                    <i class="bi bi-star-half text-warning"></i>
                    <span class="ms-2 text-muted">(4.5/5 - 128 đánh giá)</span>
                </div>

                <!-- Price -->
                <div class="price-section mb-4">
                    <h3 class="price text-danger fw-bold mb-0">
                        @Model.Price.ToString("N0") <sup>đ</sup>
                    </h3>
                    <small class="text-muted text-decoration-line-through">
                        @((Model.Price * 1.2m).ToString("N0")) đ
                    </small>
                    <span class="badge bg-danger ms-2">-17%</span>
                </div>

                <!-- Stock Status -->
                <div class="stock-status mb-4">
                    @if (Model.Stock > 0)
                    {
                        <div class="alert alert-success d-flex align-items-center">
                            <i class="bi bi-check-circle-fill fs-4 me-3"></i>
                            <div>
                                <strong>Còn hàng</strong><br>
                                <small>Còn lại @Model.Stock sản phẩm</small>
                            </div>
                        </div>
                    }
                    else
                    {
                        <div class="alert alert-danger d-flex align-items-center">
                            <i class="bi bi-x-circle-fill fs-4 me-3"></i>
                            <div>
                                <strong>Hết hàng</strong><br>
                                <small>Vui lòng quay lại sau</small>
                            </div>
                        </div>
                    }
                </div>

                <!-- Product Details -->
                <div class="product-specs mb-4">
                    <h5 class="fw-bold mb-3">Thông tin sản phẩm</h5>
                    <table class="table table-borderless">
                        <tbody>
                            <tr>
                                <td width="150"><i class="bi bi-box me-2"></i> Mã SP:</td>
                                <td><strong>#@Model.Id</strong></td>
                            </tr>
                            @if (!string.IsNullOrEmpty(Model.Size))
                            {
                                <tr>
                                    <td><i class="bi bi-rulers me-2"></i> Kích cỡ:</td>
                                    <td><strong>@Model.Size</strong></td>
                                </tr>
                            }
                            @if (!string.IsNullOrEmpty(Model.Material))
                            {
                                <tr>
                                    <td><i class="bi bi-patch-check me-2"></i> Chất liệu:</td>
                                    <td><strong>@Model.Material</strong></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>

                <!-- Add to Cart Form -->
                @if (Model.Stock > 0)
                {
                    <form asp-controller="Cart" asp-action="Add" method="post">
                        <input type="hidden" name="productId" value="@Model.Id" />

                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <label class="form-label fw-bold">Số lượng:</label>
                                <div class="input-group">
                                    <button type="button" class="btn btn-outline-secondary" onclick="decreaseQty()">
                                        <i class="bi bi-dash"></i>
                                    </button>
                                    <input type="number" name="quantity" id="quantity" class="form-control text-center"
                                           value="1" min="1" max="@Model.Stock" required />
                                    <button type="button" class="btn btn-outline-secondary" onclick="increaseQty()">
                                        <i class="bi bi-plus"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="bi bi-cart-plus me-2"></i> Thêm vào giỏ hàng
                            </button>
                            <button type="button" class="btn btn-outline-danger btn-lg">
                                <i class="bi bi-heart me-2"></i> Yêu thích
                            </button>
                        </div>
                    </form>
                }

                <!-- Features -->
                <div class="features mt-4">
                    <div class="row g-3">
                        <div class="col-6">
                            <div class="feature-box">
                                <i class="bi bi-truck text-primary"></i>
                                <small>Giao hàng nhanh</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="feature-box">
                                <i class="bi bi-shield-check text-success"></i>
                                <small>Bảo hành 1 năm</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="feature-box">
                                <i class="bi bi-arrow-repeat text-warning"></i>
                                <small>Đổi trả 7 ngày</small>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="feature-box">
                                <i class="bi bi-credit-card text-info"></i>
                                <small>Thanh toán COD</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- DESCRIPTION TAB -->
    <div class="row mt-5">
        <div class="col-12">
            <ul class="nav nav-tabs" id="productTab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="description-tab" data-bs-toggle="tab"
                            data-bs-target="#description" type="button">
                        <i class="bi bi-file-text me-2"></i> Mô tả
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reviews-tab" data-bs-toggle="tab"
                            data-bs-target="#reviews" type="button">
                        <i class="bi bi-star me-2"></i> Đánh giá (128)
                    </button>
                </li>
            </ul>

            <div class="tab-content p-4 bg-white rounded-bottom shadow-sm" id="productTabContent">
                <div class="tab-pane fade show active" id="description">
                    @if (!string.IsNullOrEmpty(Model.Description))
                    {
                        <p style="white-space: pre-line;">@Model.Description</p>
                    }
                    else
                    {
                        <p>Sản phẩm chất lượng cao, thiết kế hiện đại, phù hợp với mọi lứa tuổi. Chất liệu cao cấp, bền đẹp theo thời gian.</p>
                    }
                </div>

                <div class="tab-pane fade" id="reviews">
                    <div class="text-center py-5 text-muted">
                        <i class="bi bi-chat-dots fs-1"></i>
                        <p class="mt-3">Chức năng đánh giá sẽ được cập nhật sớm!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .main-image-wrapper {
        position: relative;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }

        .main-image-wrapper img {
            width: 100%;
            height: auto;
            transition: transform 0.5s ease;
        }

        .main-image-wrapper:hover img {
            transform: scale(1.05);
        }

    .image-badges {
        position: absolute;
        top: 20px;
        right: 20px;
    }

        .image-badges .badge {
            font-size: 1rem;
            padding: 10px 20px;
            border-radius: 25px;
        }

    .product-title {
        font-size: 2rem;
        font-weight: 700;
        color: #2c3e50;
    }

    .price {
        font-size: 2.5rem;
    }

    .feature-box {
        text-align: center;
        padding: 15px;
        border: 1px solid #e0e0e0;
        border-radius: 10px;
        transition: all 0.3s ease;
    }

        .feature-box:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .feature-box i {
            font-size: 1.5rem;
            display: block;
            margin-bottom: 5px;
        }

    .nav-tabs .nav-link {
        color: #666;
        border: none;
        border-bottom: 3px solid transparent;
        font-weight: 600;
    }

        .nav-tabs .nav-link.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: transparent;
        }

    .input-group .btn {
        min-width: 40px;
    }

    #quantity {
        max-width: 100px;
        font-weight: bold;
    }
</style>

<script>
    function increaseQty() {
        let qty = document.getElementById('quantity');
        let max = parseInt(qty.max);
        let current = parseInt(qty.value);
        if (current < max) {
            qty.value = current + 1;
        }
    }

    function decreaseQty() {
        let qty = document.getElementById('quantity');
        let current = parseInt(qty.value);
        if (current > 1) {
            qty.value = current - 1;
        }
    }
</script>
